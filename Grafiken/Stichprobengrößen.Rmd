---
title: "Stichprobengrößen"

output:
  html_document:
    keep_md: true
    toc: yes
---

```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r daten}

# allgemein
library(ggplot2)
library(foreign)
library(Hmisc)
library(car)
library(plyr)
library(dplyr)
library(magrittr)
library(scales)
library(haven)

# Kreuztabellen
library(gmodels)

# working directory
#setwd("/Users/thomask/Dropbox/Soziologie/Frauen\ in\ der\ Wissenschaft/quantitative\ Erhebung/Arbeitsbereich\ Thomas/Berechnungen")

# daten einlesen -----------
df <- read.spss("../Data/DATENSATZ_FiW-main12_2.sav", use.value.labels=T, to.data.frame=T)
df_sav <- tbl_df(df)


# alternativer datensatz für andere Grafiken
df_haven <- read_sav("../Data/DATENSATZ_FiW-main12_2.sav")

```


In diesem File finden sich die Kreuztabellen und sonstige Darstellungen mit den zu den Grafiken gehörenden Stichprobengrößen.


# Grafik: Motivationsskalen

````{r motivationsindizes}
df_haven %>%
  select(contains("Motivation"), q_24)  %>% 
  as.matrix %>% # get rid of "labelled" class which doesn't work with dplyr right now
  data.frame %>%
  mutate(q_24 = factor(q_24, labels=c("weiblich", "männlich")))  %>% 
  filter(q_24 != "NA") -> pdata # personen rausschmeißen, die als Geschlecht NA haben


colSums(!is.na(pdata[,1:4]))
````

# Grafik: Motive ein Doktoratsstudium aufzunehmen
Dargestellt sind jeweils die Ns für die einzelnen Variablen.

```{r motive}
motive <- df_sav %>%
  select(., q_6_1:q_6_16)

# N für die einzelnen Items
colSums(!is.na(motive))

```

# Grafik: Nachgedacht, abzubrechen

````{r abbruchgedanken}
df_haven %>%
  select(q_14:q_15_15, q_15_17, q_24) %>%
  mutate(q_24 = labelled(q_24, c(weiblich = 1, männlich = 2))) %>% # bug in as_factor umgehen: geschlecht hat 3 ausprägungen, es kommen aber nur 2 vor
  lapply(., as_factor) %>%
  data.frame %>%
  filter(q_14 == "Ja") %>%
  tbl_df -> abbruchgedanken
````

**Stichprobengröße Frauen**
```{r}
abbruchgedanken %>%
  filter(q_24 == "weiblich") %>%
  tally
```


**Stichprobengröße Männer**
```{r}
abbruchgedanken %>%
  filter(q_24 == "männlich") %>%
  tally
```


# Schwierigkeit, BetreuerIn zu finden nach Geschlecht
```{r betreuer_in}
CrossTable(df_sav$q_9, df_sav$q_24, prop.r=F, prop.t=F, prop.chisq=F, format = "SPSS")
```

Insgesamt hatten 25 Personen angegeben, dass es sehr einfach war, eine/n BetreuerIn zu finden, von denen gaben aber 2 bei Geschlecht nichts an, daher ist N bei dieser Grafik insgesamt nur 37.


# Geschlecht von Betreuer_in mit Geschlecht des/der Befragten als UV
```{r geschlecht betreuer mit geschlecht als AV}
CrossTable(df_sav$q_8, df_sav$q_24, prop.r=F, prop.t=F, prop.chisq=F, format = "SPSS")
````

# Grafik: Informationen über das Studium
Dargestellt sind jeweils die Ns für die einzelnen Variablen.

```{r informationen}
motive <- df_sav %>%
  select(., q_20_1:q_20_8)

# N für die einzelnen Items
colSums(!is.na(motive))

```



